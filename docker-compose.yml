services:
  comfy-1:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56781:8188"
    volumes:
      - ./comfy-1:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]

  comfy-2:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56782:8188"
    volumes:
      - ./comfy-2:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]

  comfy-3:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56783:8188"
    volumes:
      - ./comfy-3:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]

  comfy-4:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56784:8188"
    volumes:
      - ./comfy-4:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]

  comfy-5:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56785:8188"
    volumes:
      - ./comfy-5:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]


  comfy-9:
    image: sidaliu/comfyui:comfy-cli
    ports:
      - "56789:8188"
    volumes:
      - ./comfy-9:/home/runner
      - ./comfy-public:/comfy-public
    environment:
      - http_proxy=http://host.docker.internal:17890
      - https_proxy=http://host.docker.internal:17890
      - CLI_ARGS=--enable-cors-header=http://heartai.cn
    extra_hosts:
      - "host.docker.internal:host-gateway"
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: ["gpu"]
